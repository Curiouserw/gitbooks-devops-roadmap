# 性能测试指标

# 一、概念

## 1、并发数（Concurrent）

并发数（Concurrent）是指系统同时能处理的请求数量，这个也是反应了系统的负载能力。

指同一时间点对业务功能同时操作的用户数，可以分为两种：一种是严格意义上的并发，即所有的用户在同一时刻做同一件事或操作，这时业务功能一般指同一类型的业务；另外一种并发是广义范围的并发，这种并发与前一种并发的区别是，尽管多个用户对系统发出了请求或者进行了操作，但是这些请求或都操作可以是相同的，也可以是不同的，这时业务功能可能不是同一类型的业务。

## 2、响应时间（Response Time）

响应时间（response time）是一个系统最重要的指标之一，它的数值大小直接反应了系统的快慢。响应时间是指执行一个请求从开始到最后收到响应数据所花费的总体时间。

##  3、吞吐量（Throughput）

吞吐量（Throughput）是指单位时间内系统能处理的请求数量，体现系统处理请求的能力，这是目前最常用的性能测试指标。

一段时间内应用系统处理用户的请求数（以下介绍指单位时间内，也可以理解为吞吐率），这个定义考察点一般是系统本身因素；当然也可以用单位时间内流经被测系统的数据流量，一般单位为b/s,即每秒钟流经的字节数，这个定义的考察点既有系统本身因素也有网络，外设等因素，也可以理解为除客户端以外的测试环境及被测系统。

跟吞吐量有关：并发数、响应时间。

吞吐量的常用量化指标：QPS、TPS、HPS

QPS（TPS），并发数、响应时间它们三者之间的关系是：QPS（TPS）= 并发数 / 平均响应时间

### ①**QPS（每秒查询数）**

QPS：Queries Per Second，意思是每秒查询率，是一台服务器每秒能够响应的查询次数（数据库中的每秒执行查询sql的次数），不能描述增删改.



### ②TPS（每秒事务数）

TPS：Transactions Per Second，意思是每秒事务数，具体事务的定义，都是人为的，可以一个接口、多个接口、一个业务流程等等。一个事务是指事务内第一个请求发送到接收到最后一个请求的响应的过程，以此来计算使用的时间和完成的事务个数。

- **TPS 总结**

  - 利用并发用户数、期望响应时间，可以计算出TPS。
  - TPS只是用来计算的是期望值，性能测试过程中的TPS无法单独作为性能指标。
  - TPS数据方位理论值赢在10-100之间，低于10和高于100都说明系统存在瓶颈点。
  - 利用TPS与平均事物响应时间进行对比，可以分析事物数码对执行时间的影响。例：当压力加大，点击率/tps曲线如果变化缓慢或者有平坦趋势，很有可能是服务器开始出现瓶颈。
  - TPS是从客户端角度审视服务器处理能力，不能证明TPS可以达到什么程度就能支持多少并发，两者没有必然联系。
  - TPS会受到负载的影响，也会随着负载的增加而逐渐增加，当系统进入繁忙期后，TPS会有所下降。

- **TPS与响应时间的关系**
  1、TPS和响应时间在理想状态下的额定值。如果20个入口，并发数只有10的时候，TPS就是10，而响应时间始终都是1，说明并发不够，需要增加并发数达到TPS的峰值。

  2、如果增加到100并发，则造成了线程等待，引起平均响应时间从 1 秒变成 3 秒，TPS也从20下降到9；TPS和响应时间都是单独计算出来的，两者不是互相计算出来的。

  3、响应时间和TPS在宏观上是反比的关系，但是两者之间没有直接关系。

- **TPS 性能测试中的作用**
  反映了系统在同一时间内处理业务的最大能力，这个数据越高，说明处理能力越强，描述（看到系统的TPS随着时间的变化逐渐变大，而在不到多少分钟的时候系统
  　　每秒可以处理多少个事物。这里的最高值并不一定代表系统的最大处理能力，TPS会受到负载的影响，也会随着负载增加而逐渐增加，当系统进入繁忙期后，TPS会有所下降。）而在几分钟以后开始出现少量的失败事物）

  - 一个系统的吞吐量（承压能力）与request 对CPU的消耗、外部接口、IO等紧密关联。单个request对CPU消耗越高，外部系统接口、IO营销速度越慢，系统吞吐能力越低，反之越高。
  - 系统吞吐量几个重要参数：TPS、并发数、响应时间（TPS = 并发数 / 平均响应时间）
  - 利用TPS计算系统最高日吞吐量；
  - 找出系统最高TPS和日PV，这两个要素有相对比较稳定的关系。
  - 通过压力测试或者经营评估，得出最高TPS，然后跟进的关系，计算出系统最高日吞吐量。例如：B2B中文和淘宝对客户群不一样，这两个客户群的网络行为不应用，他们之间的TPS和PV关系比例也不一样。

### ③HPS（每秒HTTP请求数）

HPS：Hits per Second 每秒点击次数，是指在一秒钟的时间内用户对Web页面的链接、提交按钮等点击总和。 它一般和TPS成正比关系，是B/S系统中非常重要的性能指标之一。
